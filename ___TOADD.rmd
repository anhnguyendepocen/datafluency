
XXX THIS SHOWS UPLOADING NOT LOADING FROM WEB
# Sequences and designs for sampling and allocation

One trick you will need later in the course is making **sequences** of numbers.

There are a few ways to do this, but the simplest is to write: `1:10`. That is, the number to start
from (`1`), a colon (`:`), and then the number to end with (`10`).

Copy and paste these examples to see the output:

```{r}
1:10
20:30
```

**Explanation**: The output shows that R has created a sequence of whole numbers between the start
and finish number.

To get a sequence with only even numbers, we can use the `seq` function, and set the `by` argument
to 2:

```{r}
seq(from=2, to=10, by=2)
```

You can set `by` to any number, including a decimal:

```{r}
seq(0, 27, by=3)
seq(0, 1, by=0.2)
```

If your sequence doesn't have a simple pattern, you can also write out the numbers by hand using the
`c(..)` command:

```{r}
c(1,40,92,188)
```

**Explanation**: `c(...)` is short for `combine`, so this command combines the numbers 1, 40, 92,
188 into a new sequence. This is sometimes called a **vector** in R-speak.

:::{.exercise}

Make some sequences which include:

-   Even numbers from 10 to 20
-   Numbers in the 8 times table less than 200
-   20 evenly spaced numbers between zero and 1 (including zero and 1)
-   The words "Wibble", "Wobble" and "Bobble"

`r hide("Show answers")`

We can use `seq` for numbers:

```{r}
seq(10,20,by=2)
seq(0,200, 8)
seq(0,1, by=1/19)
```

But we need to use c() for lists of words:

```{r}
c("Wibble", "Wobble", "Bobble")
```

`r unhide()`

:::

### Combinations of sequences {#expand-grid}

In designing experiments we often want to create combinations of different categories which
represent conditions or stimuli.

Imagine a hypothetical study with a test phase where participants are presented with multiple words,
in either red or green text, and shown at either the bottom or top of the computer screen.

The combinations look something like this:

```{r echo=F}
expand.grid(
   colour=c("Red", "Green"),
   position=c("Top", "Bottom"),
   word = c("Nobble", "Wobble", "Hobble")) %>%
   as_tibble() %>%
mutate(condition = row_number())%>% select(condition, everything())%>%
pander()
```

R provides quick ways of creating combinations of variables, using a command called `expand.grid`.

First, we need to create a sequence of each of the possible values for our categories:

```{r}
colours = c("Red", "Green")
positions = c("Top", "Bottom")
words = c("Nobble", "Wobble", "Hobble")
```

Then we can use `expand.grid` to give us all the possible combinations of these:

```{r}
expand.grid(colour=colours, position=positions, words = words)
```

**Explanation**: The `expand.grid` function has taken the items in the three input sequences
(colours, positions and words) and created a dataframe which contains all the possible combinations. We could save these to a file if we wanted to use them as part of our experiment.

#### Task: create some experimental designs of your own {.exercise}

1. Reproduce the experiment design above by copying and pasting

2. Adapt the commands to allow for an experiment where the word position could be either top,
   bottom, left or right. How many different conditions would there be in this case?

As an optional stretch task:

1. How would you create a design where the order of presentation of each word is also balanced? That
   is, where it's equally likely to see Nobble, Wobble or Bobble in the first, second or third
   trial?

### Random samples

In our example, each of the experimental conditions is allocated between-participants, which (as
you'll learn elsewhere in the programme) means we need recruit quite a large number of participants.
In this case we can imagine we might need at least 250 participants.

Allocating participants to condition is another boring task R can help with. The trick is to combine
sequences with randomness and random sampling.

For example, we might create a sequence of the numbers from 1:10:

```{r}
1:10
```

The `sample` function lets us take a random sample from this sequence:

```{r}
sample(1:10)
```

**Explanation** `sample` has shuffled the input sequence and gives us the original numbers (1...12)
in a random order.

---

If we want to take a larger sample, longer than the input sequence, we have to add the text
`replace=TRUE`:

```{r}
sample(1:10, size = 20, replace=TRUE)
```

**Explanation**: Using `replace=TRUE` is like picking a number from a hat, but then putting the
chosen number back into the hat so it can be picked again. This allows us to make longer random
sequences where numbers in the initial sequence are repeated.

### In-use: Randomising participants to conditions/groups

If we combine our experimental design from above with this idea of randomness we can randomise
participants to conditions in our experiment.

If we look again at our design we can see there are 12 possible combinations:

```{r}
expand.grid(colour=colours, position=positions, words = words)
```

We can use `sample` to make sure we allocate participants randomly to conditions, as they are
recruited:

```{r}
sample(1:12, size=250, replace=TRUE)
```

So, we would allocate participants to their condition in this order as they are recruited.

Alternatively, we could simply run this every time a new participant showed up:

```{r}
(new_allocation <- sample(1:12, size=1))
```

#### Task: Randomise your own participants {.exercise}

1. Re-use the design you created above, and randomise 5 participants to conditions within it.

2. Try and create a design which might work for your own study (either this year, based on your UG
   project, or on any other study you might like to run).

As an optional stretch task:

1. [Read this extension, which shows how to sample from datasets as well as sequences](#sample_n)


# Extension tasks {#optional-extensions}

### Missing data: Try the same code on another dataset {.exercise}

The `mice` package includes example datasets with missing data. We can look at one of these like so:

```{r}
mice::boys %>% glimpse
```

1. Identify the patterns of missing dataset in the `mice::boys` dataset.

2. How many participants provided complete data?



<!-- mice::boys %>% mice::md.pattern() -->


